---
phase: 10
plan: 2
wave: 2
depends_on: ["10.1"]
files_modified:
  - src/app/checkout/page.tsx
  - src/app/checkout/confirmation/page.tsx
  - src/lib/orders.ts
autonomous: true
must_haves:
  truths:
    - "Checkout page has a 'Pay with Razorpay' button"
    - "Clicking opens the Razorpay payment modal"
    - "After payment, user lands on confirmation page"
    - "Orders saved to localStorage"
  artifacts:
    - "src/app/checkout/page.tsx has Razorpay integration"
    - "src/app/checkout/confirmation/page.tsx shows receipt"
---

# Plan 10.2: Razorpay Checkout UI + Confirmation

<objective>
Add "Pay with Razorpay" button to /checkout. On click: create order via API → open Razorpay modal → verify payment → save order → redirect to confirmation.
</objective>

<context>
- src/app/checkout/page.tsx
- src/app/api/create-order/route.ts
- src/app/api/verify-payment/route.ts
</context>

<tasks>

<task type="auto">
  <name>Create Order Storage Utility</name>
  <files>src/lib/orders.ts</files>
  <action>
    localStorage utility: getOrders(), saveOrder(). Key: `omegatech_orders`.
  </action>
  <verify>npm run build</verify>
  <done>src/lib/orders.ts exports order functions.</done>
</task>

<task type="auto">
  <name>Integrate Razorpay into Checkout + Confirmation Page</name>
  <files>src/app/checkout/page.tsx, src/app/checkout/confirmation/page.tsx</files>
  <action>
    1. Load Razorpay script via next/script
    2. "Pay ₹X with Razorpay" button below Grand Total
    3. Handler: fetch /api/create-order → open Razorpay modal → on success fetch /api/verify-payment → saveOrder → router.push confirmation
    4. Confirmation page: reads orderId/paymentId from URL params, shows receipt
    5. Add `declare global { interface Window { Razorpay: any } }`
    6. Theme: `{ color: '#18181b' }`
    7. Prefill empty name/email/contact
  </action>
  <verify>npm run build</verify>
  <done>End-to-end payment flow builds and is ready for test keys.</done>
</task>

</tasks>

<success_criteria>
- [ ] Pay button visible on /checkout
- [ ] Confirmation page renders
- [ ] Build passes
</success_criteria>
