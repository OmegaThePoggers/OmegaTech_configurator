---
phase: 8
plan: 2
wave: 2
depends_on: ["8.1"]
files_modified:
  - src/app/build/page.tsx
autonomous: true
must_haves:
  truths:
    - "PCViewer on /build receives the current `selectedComponents` from the configurator state"
    - "When user selects a component, the 3D viewer immediately updates"
    - "Brand-specific colors appear in the viewer matching the selected component's brand field"
  artifacts:
    - "src/app/build/page.tsx passes selectedComponents to PCViewer"
---

# Plan 8.2: Wire PCViewer to Build Page State

<objective>
Connect the reactive PCViewer to the /build page's selectedComponents state so the 3D viewer responds in real-time as the user configures their PC.

Purpose: Complete the feedback loop — user picks a part, viewer updates instantly.
Output: The /build page passes live state to PCViewer.
</objective>

<context>
Load for context:
- src/app/build/page.tsx (configurator state)
- src/components/viewer/PCViewer.tsx (updated reactive viewer from Plan 8.1)
</context>

<tasks>

<task type="auto">
  <name>Pass selectedComponents to PCViewer</name>
  <files>src/app/build/page.tsx</files>
  <action>
    1. Find the `<PCViewer>` usage in the build page (in the 3D viewer section).

    2. Transform the `selectedComponents` state into the shape PCViewer expects:
       ```ts
       const viewerComponents = useMemo(() => {
         const result: Record<string, any> = {};
         Object.entries(selectedComponents).forEach(([category, item]) => {
           if (item) {
             result[category] = {
               name: item.name,
               brand: item.brand,
               tdp: item.tdp,
               length: item.length,
               wattage: item.wattage,
               modules: item.modules,
               ddrGeneration: item.ddrGeneration,
             };
           }
         });
         return result;
       }, [selectedComponents]);
       ```

    3. Pass it as a prop:
       ```tsx
       <PCViewer className="..." selectedComponents={viewerComponents} />
       ```

    AVOID: Changing any other part of the build page UI.
    AVOID: Modifying the PCViewer on the homepage — that one stays static/default.
  </action>
  <verify>npm run build</verify>
  <done>The PCViewer in /build receives and displays the current selectedComponents. Selecting a component causes immediate visual feedback in the 3D viewer.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Build passes cleanly
- [ ] PCViewer on /build receives selectedComponents prop
- [ ] Homepage PCViewer continues to work without props (default ghost state)
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
