---
phase: 5
plan: 1
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/components/viewer/PCViewer.tsx
autonomous: true
must_haves:
  truths:
    - "React Three Fiber and Drei are installed as dependencies"
    - "A reusable PCViewer component renders a 3D wireframe PC case with internal components"
    - "OrbitControls allow rotation/zoom of the 3D model"
    - "The viewer is responsive and handles window resizing"
  artifacts:
    - "src/components/viewer/PCViewer.tsx exists and renders meshes"
---

# Plan 5.1: Create 3D PC Viewer Component

<objective>
Port the legacy `3d-viewer.js` (vanilla Three.js) into a reusable React Three Fiber component. This component will render a transparent wireframe PC case with internal components (motherboard, CPU, RAM sticks, GPU, PSU) using the same geometry and positioning from the legacy code.

Purpose: Replace the placeholder 3D viewer area on the /build page with an interactive 3D model.
Output: A `PCViewer` component using @react-three/fiber and @react-three/drei.
</objective>

<context>
Load for context:
- legacy/3d-viewer.js (source geometry, positions, materials to port)
- src/app/build/page.tsx (where the viewer placeholder currently lives)
</context>

<tasks>

<task type="auto">
  <name>Install React Three Fiber and Drei</name>
  <files>package.json</files>
  <action>
    Run: `npm install three @react-three/fiber @react-three/drei @types/three`

    This installs:
    - `three` — core Three.js library
    - `@react-three/fiber` — React renderer for Three.js
    - `@react-three/drei` — helper components (OrbitControls, etc.)
    - `@types/three` — TypeScript types

    AVOID: Installing `react-three-fiber` (old package name). Use `@react-three/fiber`.
  </action>
  <verify>grep "@react-three/fiber" package.json</verify>
  <done>All 4 packages appear in package.json dependencies.</done>
</task>

<task type="auto">
  <name>Create PCViewer Component</name>
  <files>src/components/viewer/PCViewer.tsx</files>
  <action>
    Create `src/components/viewer/PCViewer.tsx` as a 'use client' component.

    **Port the following from `legacy/3d-viewer.js`:**

    1. **Canvas setup:** Use `<Canvas>` from @react-three/fiber with:
       - `camera={{ position: [0, 0, 4], fov: 75 }}`
       - transparent background (`gl={{ alpha: true }}`)

    2. **PC Case (transparent wireframe):**
       - BoxGeometry(2.5, 4, 2) with MeshBasicMaterial(0x00ffff, opacity 0.1)
       - EdgesGeometry for cyan wireframe lines via `<lineSegments>`

    3. **Motherboard:** BoxGeometry(1.8, 3.5, 0.1), color 0x222222, opacity 0.8, position x=-0.2

    4. **CPU:** BoxGeometry(0.4, 0.4, 0.2), color 0x00aaaa, position (-0.2, 1, 0.1)

    5. **RAM (2 sticks):** BoxGeometry(0.15, 0.8, 0.05), color 0x00cccc
       - ram1 at (0.4, 1, 0.1), ram2 at (0.6, 1, 0.1)

    6. **GPU:** BoxGeometry(1.2, 0.2, 0.6), color 0x008888, position (0.1, 0, 0.3)

    7. **PSU:** BoxGeometry(1.2, 0.8, 1), color 0x333333, position (0, -1.3, 0)

    8. **Lighting:** AmbientLight(0xffffff, 0.7) + PointLight(0xffffff, 1) at (5,5,5)

    9. **Controls:** Use `<OrbitControls>` from @react-three/drei with:
       - enableDamping, dampingFactor 0.05
       - minDistance 2, maxDistance 10

    **Component API:**
    ```tsx
    export function PCViewer({ className }: { className?: string })
    ```

    The Canvas should fill its parent container. Wrap in a div with the className prop.

    AVOID: Using `useEffect` + raw Three.js. Use declarative R3F JSX throughout.
    AVOID: Using `<Edges>` from drei if it causes issues — use manual `<lineSegments>` with `<edgesGeometry>` instead.
  </action>
  <verify>npm run build</verify>
  <done>PCViewer component renders a 3D wireframe PC case with all internal components matching the legacy layout. OrbitControls allow rotation and zoom.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] @react-three/fiber is in package.json
- [ ] PCViewer.tsx exists and exports a component
- [ ] Build succeeds without errors
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
